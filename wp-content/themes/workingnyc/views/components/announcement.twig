{# @Type   Component #}
{# @For    Post Type #}
{# @Class  timber-posts/Announcements.php #}
<article class="c-card c-card-transparent h-full">
  <header class="c-card__header pb-2">
    <a href="{{ function('convert_link_locale', this.link , site.site_url, site.url) }}" target="{{ this.target }}" class="c-card__header-link">
      <h5 class="c-card__title">
        {% if this.date_updated|date('U') > this.status_period|date('U') %}
        <mark class="badge" title="{{ this.status_title }}">
          {{ this.status }}
        </mark>
        {% endif %}

        <span>{{ this.announcement_title }}</span>

        {% if this.target == '_blank' %}
        <svg aria-hidden="true" class="icon-ui">
          <use href="#lucide-external-link"></use>
        </svg>
        {% endif %}
      </h5>
    </a>
  </header>

  <div class="c-card__body pt-2 tablet:pt-3">
    <div class="c-card__summary height-176px overflow-hidden">
    <ul class="c-card__features">
      {% if this.announcement_date is not empty %}
        <li>
          <svg class="icon-ui c-card__feature-icon" role="img">
            <title>{{ __('Date', 'WNYC') }}</title>

            <use href="#lucide-calendar"></use>
          </svg>
          <span>{{ this.announcement_date|date(fn('get_option', 'date_format')) }}</span>
        </li>
      {% endif %}
      {% if this.announcement_start_time is not empty %}
        <li>
          <svg class="icon-ui c-card__feature-icon" role="img">
            <title>{{ __('Time', 'WNYC') }}</title>

            <use href="#temp-lucide-clock"></use>
          </svg>
          <span>
            {{ this.announcement_start_time|date(fn('get_option', 'time_format')) }}
            {% if this.announcement_end_time is not empty %}
              {{ __('to', 'WNYC') }}
              {{ this.announcement_end_time|date(fn('get_option', 'time_format')) }}
            {% endif %}
          </span>
        </li>
      {% endif %}
      {% if this.announcement_location is not empty %}
        <li>
          <svg class="icon-ui c-card__feature-icon" role="img">
            <title>{{ __('Location', 'WNYC') }}</title>

            <use href="#lucide-map-pin"></use>
          </svg>
          <span>{{ this.announcement_location }}</span>
        </li>
      {% endif %}
      </ul>
      {{ this.announcement_details|wpautop }}
    </div>

    <ul class="c-card__features">
      <li>
        <svg class="icon-ui c-card__feature-icon" role="img">
          <title>{{ __('Last Updated', 'WNYC') }}</title>

          <use href="#lucide-info"></use>
        </svg>

        <span>
          {{ __('Updated', 'WNYC') }}
          {{ this.date_updated|date(fn('get_option', 'date_format')) }}
          {{ this.date_updated|date(fn('get_option', 'time_format')) }}
        </span>
      </li>
    </ul>

    <div class="c-card__web-share">
      {% set announcement_share_id = fn('uniqid') %}

      {% include 'components/web-share.twig' with {this: {
        id: announcement_share_id,
        class: 'z-30',
        share: {
          'title': this.announcement_title,
          'text': this.announcement_details|striptags,
          'url': this.short_link,
          'subject': __('this announcement', 'WNYC')
        }
      }} only %}
    </div>

    {# @span This empty span tag currently assists the stylesheet in removing margin on the last visible element in the card. #}
    <span></span>
  </div>
</article>